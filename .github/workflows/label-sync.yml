name: 🏷️ Sync Labels Across Repositories

on:
  push:
    branches: [main]
    paths: ['.github/labels.yml']
  workflow_dispatch:
    inputs:
      repositories:
        description: 'Comma-separated list of repositories to sync (or leave empty for all)'
        required: false
        type: string

jobs:
  sync-labels:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      metadata: read
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Create labels config if not exists
        run: |
          if [ ! -f .github/labels.yml ]; then
            cat > .github/labels.yml << 'EOF'
          # 🐛 Bug Reports
          - name: "bug"
            color: "d73a4a"
            description: "Something isn't working"
            
          - name: "critical"
            color: "b60205"
            description: "Critical bug that needs immediate attention"
            
          # ✨ Features & Enhancements
          - name: "enhancement"
            color: "a2eeef"
            description: "New feature or request"
            
          - name: "feature"
            color: "0075ca"
            description: "New feature implementation"
            
          # 📚 Documentation
          - name: "documentation"
            color: "0052cc"
            description: "Improvements or additions to documentation"
            
          # 🧹 Maintenance
          - name: "maintenance"
            color: "fbca04"
            description: "Repository maintenance and housekeeping"
            
          - name: "refactor"
            color: "fbca04"
            description: "Code refactoring without changing functionality"
            
          # ❓ Questions & Help
          - name: "question"
            color: "d876e3"
            description: "Further information is requested"
            
          - name: "help wanted"
            color: "008672"
            description: "Extra attention is needed"
            
          - name: "good first issue"
            color: "7057ff"
            description: "Good for newcomers"
            
          # 🚦 Status Labels
          - name: "needs-triage"
            color: "ffa500"
            description: "Needs to be triaged by maintainers"
            
          - name: "needs-reproduction"
            color: "ffa500"
            description: "Needs a reproduction case"
            
          - name: "needs-discussion"
            color: "ffa500"
            description: "Needs further discussion"
            
          - name: "ready-for-review"
            color: "0e8a16"
            description: "Ready for code review"
            
          - name: "work-in-progress"
            color: "c5def5"
            description: "Work in progress"
            
          # 🎯 Priority
          - name: "priority-low"
            color: "e4e669"
            description: "Low priority"
            
          - name: "priority-medium"
            color: "fbca04"
            description: "Medium priority"
            
          - name: "priority-high"
            color: "d93f0b"
            description: "High priority"
            
          - name: "priority-critical"
            color: "b60205"
            description: "Critical priority"
            
          # 🔒 Security
          - name: "security"
            color: "b60205"
            description: "Security related issue"
            
          # 👋 Community
          - name: "👋 first-time-contributor"
            color: "ff69b4"
            description: "First contribution by this person"
            
          # ⏰ Automation
          - name: "⏰ stale"
            color: "795548"
            description: "Marked as stale due to inactivity"
            
          # 🚫 Won't Fix
          - name: "wontfix"
            color: "ffffff"
            description: "This will not be worked on"
            
          - name: "duplicate"
            color: "cfd3d7"
            description: "This issue or pull request already exists"
            
          - name: "invalid"
            color: "e4e669"
            description: "This doesn't seem right"
            
          # 🎨 Design
          - name: "design"
            color: "ff69b4"
            description: "Design related changes"
            
          - name: "ui"
            color: "ff69b4"
            description: "User interface changes"
            
          - name: "ux"
            color: "ff69b4"
            description: "User experience improvements"
            
          # 🧪 Testing
          - name: "testing"
            color: "c5def5"
            description: "Related to testing"
            
          # 📱 Platform Specific
          - name: "android"
            color: "3ddc84"
            description: "Android specific"
            
          - name: "ios"
            color: "007aff"
            description: "iOS specific"
            
          - name: "web"
            color: "0366d6"
            description: "Web platform specific"
            
          # 🔗 Dependencies
          - name: "dependencies"
            color: "0366d6"
            description: "Pull requests that update a dependency file"
            
          # 🚀 Release
          - name: "release"
            color: "0e8a16"
            description: "Related to releases"
          EOF
          fi
          
      - name: Sync Labels
        uses: micnncim/action-label-syncer@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          manifest: .github/labels.yml
          repository: ${{ github.repository }}
          prune: false  # Don't delete labels not in config

