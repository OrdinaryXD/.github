name: üéâ Welcome New Contributors

on:
  issues:
    types: [opened]
  pull_request_target:
    types: [opened]

jobs:
  welcome:
    if: github.event.action == 'opened'
    runs-on: ubuntu-latest
    permissions:
      issues: write
      pull-requests: write
    
    steps:
      - name: Welcome new contributor
        uses: actions/github-script@v7
        with:
          script: |
            const { owner, repo } = context.repo;
            const { actor } = context;
            const eventType = context.eventName;
            
            // Check if user is first-time contributor
            const { data: contributions } = await github.rest.repos.listContributors({
              owner,
              repo,
              per_page: 100
            });
            
            const isFirstTime = !contributions.find(contributor => 
              contributor.login === actor
            );
            
            if (!isFirstTime) return;
            
            let welcomeMessage, emoji;
            
            if (eventType === 'issues') {
              emoji = 'üêõ';
              welcomeMessage = `# ${emoji} –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ XDTeam!
            
            –ü—Ä–∏–≤–µ—Ç @${actor}! üëã
            
            –°–ø–∞—Å–∏–±–æ –∑–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –ø–µ—Ä–≤–æ–≥–æ issue –≤ –Ω–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ! –ú—ã —Ü–µ–Ω–∏–º –≤–∞—à –≤–∫–ª–∞–¥ –≤ —É–ª—É—á—à–µ–Ω–∏–µ –Ω–∞—à–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤.
            
            ## üìã –ß—Ç–æ –¥–∞–ª—å—à–µ?
            
            - –ù–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç –≤–∞—à issue –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è
            - –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –º—ã –ø–æ–ø—Ä–æ—Å–∏–º –µ—ë –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö
            - –°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ - –º—ã —Å—Ç–∞—Ä–∞–µ–º—Å—è –æ—Ç–≤–µ—á–∞—Ç—å –±—ã—Å—Ç—Ä–æ!
            
            ## ü§ù –•–æ—Ç–∏—Ç–µ –≤–Ω–µ—Å—Ç–∏ –±–æ–ª—å—à–∏–π –≤–∫–ª–∞–¥?
            
            - üìñ –ò–∑—É—á–∏—Ç–µ –Ω–∞—à–µ [—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—á–∞—Å—Ç–∏—é](https://github.com/${owner}/.github/blob/main/CONTRIBUTING.md)
            - üí¨ –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –Ω–∞—à–µ–º—É [Telegram —á–∞—Ç—É](https://t.me/xdteam_dev)
            - üåü –ü–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É –ø—Ä–æ–µ–∫—Ç–∞–º, –∫–æ—Ç–æ—Ä—ã–µ –≤–∞–º –Ω—Ä–∞–≤—è—Ç—Å—è
            - üì¢ –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –¥—Ä—É–∑—å—è–º –æ XDTeam
            
            **–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ! üöÄ**`;
            } else {
              emoji = 'üéâ';
              welcomeMessage = `# ${emoji} –í–∞—à –ø–µ—Ä–≤—ã–π Pull Request!
            
            –ü—Ä–∏–≤–µ—Ç @${actor}! üëã
            
            –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –ø–µ—Ä–≤—ã–π Pull Request –≤ XDTeam! –≠—Ç–æ –≤–∞–∂–Ω—ã–π —à–∞–≥, –∏ –º—ã —Ü–µ–Ω–∏–º –≤–∞—à–µ –∂–µ–ª–∞–Ω–∏–µ —É–ª—É—á—à–∏—Ç—å –Ω–∞—à–∏ –ø—Ä–æ–µ–∫—Ç—ã.
            
            ## üîç –ü—Ä–æ—Ü–µ—Å—Å —Ä–µ–≤—å—é
            
            - –ù–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–≤–µ–¥–µ—Ç —Ä–µ–≤—å—é –≤–∞—à–µ–≥–æ –∫–æ–¥–∞
            - –ú—ã –º–æ–∂–µ–º –ø–æ–ø—Ä–æ—Å–∏—Ç—å –≤–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞
            - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è –∏ –≤–æ–ø—Ä–æ—Å–æ–≤
            
            ## ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
            
            - [ ] –í–∞—à –∫–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞—à–∏–º [—Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º](https://github.com/${owner}/.github/blob/main/CONTRIBUTING.md#—Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
            - [ ] –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ
            - [ ] PR –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø–æ —à–∞–±–ª–æ–Ω—É
            - [ ] –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)
            
            ## ü§ù –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ —Å–æ–æ–±—â–µ—Å—Ç–≤—É!
            
            - üí¨ [Telegram —á–∞—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤](https://t.me/xdteam_dev)
            - üìß [Email –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤](mailto:support@xdteam.dev)
            - üêô [–î—Ä—É–≥–∏–µ –ø—Ä–æ–µ–∫—Ç—ã XDTeam](https://github.com/${owner})
            
            **–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –≤–∫–ª–∞–¥! üôè**`;
            }
            
            // Add comment
            if (eventType === 'issues') {
              await github.rest.issues.createComment({
                owner,
                repo,
                issue_number: context.issue.number,
                body: welcomeMessage
              });
              
              // Add welcome label
              await github.rest.issues.addLabels({
                owner,
                repo,
                issue_number: context.issue.number,
                labels: ['üëã first-time-contributor']
              });
            } else {
              await github.rest.pulls.createReview({
                owner,
                repo,
                pull_number: context.issue.number,
                body: welcomeMessage,
                event: 'COMMENT'
              });
              
              // Add welcome label
              await github.rest.issues.addLabels({
                owner,
                repo,
                issue_number: context.issue.number,
                labels: ['üëã first-time-contributor']
              });
            }

